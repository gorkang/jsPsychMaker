window.jsPsych=(function(){var core={};core.version=function(){return "6.3.0"};var opts={};var timeline;var global_trial_index=0;var current_trial={};var current_trial_finished=false;var DOM_container;var DOM_target;var exp_start_time;var paused=false;var waiting=false;var loaded=false;var loadfail=false;var file_protocol=false;core.webaudio_context=null;if(typeof window!=='undefined'&&window.hasOwnProperty('webkitAudioContext')&&!window.hasOwnProperty('AudioContext')){window.AudioContext=webkitAudioContext}core.webaudio_context=(typeof window!=='undefined'&&typeof window.AudioContext!=='undefined')?new AudioContext():null;core.ALL_KEYS='allkeys';core.NO_KEYS='none';core.init=function(options){function init(){if(typeof options.timeline==='undefined'){console.error('No timeline declared in jsPsych.init. Cannot start experiment.')}if(options.timeline.length==0){console.error('No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment.')}timeline=null;global_trial_index=0;current_trial={};current_trial_finished=false;paused=false;waiting=false;loaded=false;loadfail=false;file_protocol=false;jsPsych.data.reset();var defaults={'display_element':undefined,'on_finish':function(data){return undefined},'on_trial_start':function(trial){return undefined},'on_trial_finish':function(){return undefined},'on_data_update':function(data){return undefined},'on_interaction_data_update':function(data){return undefined},'on_close':function(){return undefined},'use_webaudio':true,'exclusions':{},'show_progress_bar':false,'message_progress_bar':'Completion Progress','auto_update_progress_bar':true,'default_iti':0,'minimum_valid_rt':0,'experiment_width':null,'override_safe_mode':false,'case_sensitive_responses':false,'extensions':[]};if(window.location.protocol=='file:'&&(options.override_safe_mode===false||typeof options.override_safe_mode=='undefined')){options.use_webaudio=false;file_protocol=true;console.warn("jsPsych detected that it is running via the file:// protocol and not on a web server. To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. If you would like to override this setting, you can set 'override_safe_mode' to 'true' in jsPsych.init. For more information, see: https://www.jspsych.org/overview/running-experiments")}opts=Object.assign({},defaults,options);if(typeof opts.display_element=='undefined'){var body=document.querySelector('body');if(body===null){document.documentElement.appendChild(document.createElement('body'))}document.querySelector('html').style.height='100%';document.querySelector('body').style.margin='0px';document.querySelector('body').style.height='100%';document.querySelector('body').style.width='100%';opts.display_element=document.querySelector('body')}else{var display;if(opts.display_element instanceof Element){var display=opts.display_element}else{var display=document.querySelector('#'+opts.display_element)}if(display===null){console.error('The display_element specified in jsPsych.init() does not exist in the DOM.')}else{opts.display_element=display}}opts.display_element.innerHTML='<div class="jspsych-content-wrapper"><div id="jspsych-content"></div></div>';DOM_container=opts.display_element;DOM_target=document.querySelector('#jspsych-content');opts.display_element.tabIndex=0;if(opts.display_element.className.indexOf('jspsych-display-element')==-1){opts.display_element.className+=' jspsych-display-element'}DOM_target.className+='jspsych-content';if(opts.experiment_width!==null){DOM_target.style.width=opts.experiment_width+"px"}timeline=new TimelineNode({timeline:opts.timeline});jsPsych.pluginAPI.initAudio();jsPsych.pluginAPI.reset(opts.display_element);jsPsych.pluginAPI.createKeyboardEventListeners(opts.display_element);jsPsych.data.createInteractionListeners();window.addEventListener('beforeunload',opts.on_close);checkExclusions(opts.exclusions,function(){loadExtensions()},function(){});function loadExtensions(){if(opts.extensions.length==0){startExperiment()}else{var loaded_extensions=0;for(var i=0;i<opts.extensions.length;i+=1){var ext_params=opts.extensions[i].params;if(!ext_params){ext_params={}}jsPsych.extensions[opts.extensions[i].type].initialize(ext_params).then(()=>{loaded_extensions+=1;if(loaded_extensions==opts.extensions.length){startExperiment()}}).catch((error_message)=>{console.error(error_message)})}}}};if(document.readyState==="complete"){init()}else{window.addEventListener("load",init)}};core.progress=function(){var percent_complete=typeof timeline=='undefined'?0:timeline.percentComplete();var obj={"total_trials":typeof timeline=='undefined'?undefined:timeline.length(),"current_trial_global":global_trial_index,"percent_complete":percent_complete};return obj};core.startTime=function(){return exp_start_time};core.totalTime=function(){if(typeof exp_start_time=='undefined'){return 0}return(new Date()).getTime()-exp_start_time.getTime()};core.getDisplayElement=function(){return DOM_target};core.getDisplayContainerElement=function(){return DOM_container};core.finishTrial=function(data){if(current_trial_finished){return}current_trial_finished=true;if(typeof current_trial.css_classes!=='undefined'&&Array.isArray(current_trial.css_classes)){DOM_target.classList.remove(...current_trial.css_classes)}data=typeof data=='undefined'?{}:data;jsPsych.data.write(data);var trial_data=jsPsych.data.get().filter({trial_index:global_trial_index});var trial_data_values=trial_data.values()[0];if(typeof current_trial.save_trial_parameters=='object'){var keys=Object.keys(current_trial.save_trial_parameters);for(var i=0;i<keys.length;i+=1){var key_val=current_trial.save_trial_parameters[keys[i]];if(key_val===true){if(typeof current_trial[keys[i]]=='undefined'){console.warn(`Invalid parameter specified in save_trial_parameters. Trial has no property called "${keys[i]}".`)}else if(typeof current_trial[keys[i]]=='function'){trial_data_values[keys[i]]=current_trial[keys[i]].toString()}else{trial_data_values[keys[i]]=current_trial[keys[i]]}}if(key_val===false){if(keys[i]!=='internal_node_id'&&keys[i]!=='trial_index'){delete trial_data_values[keys[i]]}}}}if(Array.isArray(current_trial.extensions)){for(var i=0;i<current_trial.extensions.length;i+=1){var ext_data_values=jsPsych.extensions[current_trial.extensions[i].type].on_finish(current_trial.extensions[i].params);Object.assign(trial_data_values,ext_data_values)}}jsPsych.internal.call_immediate=true;if(typeof current_trial.on_finish==='function'){current_trial.on_finish(trial_data_values)}opts.on_trial_finish(trial_data_values);opts.on_data_update(trial_data_values);jsPsych.internal.call_immediate=false;if(typeof current_trial.post_trial_gap===null||typeof current_trial.post_trial_gap==='undefined'){if(opts.default_iti>0){setTimeout(nextTrial,opts.default_iti)}else{nextTrial()}}else{if(current_trial.post_trial_gap>0){setTimeout(nextTrial,current_trial.post_trial_gap)}else{nextTrial()}}};core.endExperiment=function(end_message){timeline.end_message=end_message;timeline.end();jsPsych.pluginAPI.cancelAllKeyboardResponses();jsPsych.pluginAPI.clearAllTimeouts();core.finishTrial()};core.endCurrentTimeline=function(){timeline.endActiveNode()};core.currentTrial=function(){return current_trial};core.initSettings=function(){return opts};core.currentTimelineNodeID=function(){return timeline.activeID()};core.timelineVariable=function(varname,immediate){if(typeof immediate=='undefined'){immediate=false}if(jsPsych.internal.call_immediate||immediate===true){return timeline.timelineVariable(varname)}else{return function(){return timeline.timelineVariable(varname)}}};core.allTimelineVariables=function(){return timeline.allTimelineVariables()};core.addNodeToEndOfTimeline=function(new_timeline,preload_callback){timeline.insert(new_timeline)};core.pauseExperiment=function(){paused=true};core.resumeExperiment=function(){paused=false;if(waiting){waiting=false;nextTrial()}};core.loadFail=function(message){message=message||'<p>The experiment failed to load.</p>';loadfail=true;DOM_target.innerHTML=message};core.getSafeModeStatus=function(){return file_protocol};function TimelineNode(parameters,parent,relativeID){var relative_id;var parent_node;var trial_parameters;var timeline_parameters;var node_trial_data;var progress={current_location:-1,current_variable_set:0,current_repetition:0,current_iteration:0,done:false};var self=this;this.trial=function(){if(typeof timeline_parameters=='undefined'){return jsPsych.utils.deepCopy(trial_parameters)}else{if(progress.current_location>=timeline_parameters.timeline.length){return null}else{return timeline_parameters.timeline[progress.current_location].trial()}}};this.markCurrentTrialComplete=function(){if(typeof timeline_parameters=='undefined'){progress.done=true}else{timeline_parameters.timeline[progress.current_location].markCurrentTrialComplete()}};this.nextRepetiton=function(){this.setTimelineVariablesOrder();progress.current_location=-1;progress.current_variable_set=0;progress.current_repetition+=1;for(var i=0;i<timeline_parameters.timeline.length;i+=1){timeline_parameters.timeline[i].reset()}};this.setTimelineVariablesOrder=function(){if(typeof timeline_parameters==='undefined'||typeof timeline_parameters.timeline_variables==='undefined'){return}var order=[];for(var i=0;i<timeline_parameters.timeline_variables.length;i+=1){order.push(i)}if(typeof timeline_parameters.sample!=='undefined'){if(timeline_parameters.sample.type=='custom'){order=timeline_parameters.sample.fn(order)}else if(timeline_parameters.sample.type=='with-replacement'){order=jsPsych.randomization.sampleWithReplacement(order,timeline_parameters.sample.size,timeline_parameters.sample.weights)}else if(timeline_parameters.sample.type=='without-replacement'){order=jsPsych.randomization.sampleWithoutReplacement(order,timeline_parameters.sample.size)}else if(timeline_parameters.sample.type=='fixed-repetitions'){order=jsPsych.randomization.repeat(order,timeline_parameters.sample.size,false)}else if(timeline_parameters.sample.type=='alternate-groups'){order=jsPsych.randomization.shuffleAlternateGroups(timeline_parameters.sample.groups,timeline_parameters.sample.randomize_group_order)}else{console.error('Invalid type in timeline sample parameters. Valid options for type are "custom", "with-replacement", "without-replacement", "fixed-repetitions", and "alternate-groups"')}}if(timeline_parameters.randomize_order){order=jsPsych.randomization.shuffle(order)}progress.order=order};this.nextSet=function(){progress.current_location=-1;progress.current_variable_set+=1;for(var i=0;i<timeline_parameters.timeline.length;i+=1){timeline_parameters.timeline[i].reset()}};this.advance=function(){if(progress.done){return true}if(progress.current_location==-1){if(typeof timeline_parameters!=='undefined'){if(typeof timeline_parameters.conditional_function!=='undefined'&&progress.current_repetition==0&&progress.current_variable_set==0){jsPsych.internal.call_immediate=true;var conditional_result=timeline_parameters.conditional_function();jsPsych.internal.call_immediate=false;if(conditional_result==false){progress.done=true;return true}}if(typeof timeline_parameters.on_timeline_start!=='undefined'&&progress.current_variable_set==0){timeline_parameters.on_timeline_start()}}progress.current_location=0;return this.advance()}if(typeof timeline_parameters!=='undefined'){var have_node_to_run=false;while(progress.current_location<timeline_parameters.timeline.length&&have_node_to_run==false){var target_complete=timeline_parameters.timeline[progress.current_location].advance();if(!target_complete){have_node_to_run=true;return false}else{progress.current_location+=1}}if(progress.current_variable_set<progress.order.length-1){this.nextSet();return this.advance()}else if(progress.current_repetition<timeline_parameters.repetitions-1){this.nextRepetiton();if(typeof timeline_parameters.on_timeline_finish!=='undefined'){timeline_parameters.on_timeline_finish()}return this.advance()}else{if(typeof timeline_parameters.on_timeline_finish!=='undefined'){timeline_parameters.on_timeline_finish()}if(typeof timeline_parameters.loop_function!=='undefined'){jsPsych.internal.call_immediate=true;if(timeline_parameters.loop_function(this.generatedData())){this.reset();jsPsych.internal.call_immediate=false;return parent_node.advance()}else{progress.done=true;jsPsych.internal.call_immediate=false;return true}}}progress.done=true;return true}};this.isComplete=function(){return progress.done};this.getTimelineVariableValue=function(variable_name){if(typeof timeline_parameters=='undefined'){return undefined}var v=timeline_parameters.timeline_variables[progress.order[progress.current_variable_set]][variable_name];return v};this.findTimelineVariable=function(variable_name){var v=this.getTimelineVariableValue(variable_name);if(typeof v=='undefined'){if(typeof parent_node!=='undefined'){return parent_node.findTimelineVariable(variable_name)}else{return undefined}}else{return v}};this.timelineVariable=function(variable_name){if(typeof timeline_parameters=='undefined'){return this.findTimelineVariable(variable_name)}else{var loc=Math.max(0,progress.current_location);if(loc==timeline_parameters.timeline.length){loc=loc-1}return timeline_parameters.timeline[loc].timelineVariable(variable_name)}};this.allTimelineVariables=function(){var all_tvs=this.allTimelineVariablesNames();var all_tvs_vals={};for(var i=0;i<all_tvs.length;i+=1){all_tvs_vals[all_tvs[i]]=this.timelineVariable(all_tvs[i])}return all_tvs_vals};this.allTimelineVariablesNames=function(so_far){if(typeof so_far=='undefined'){so_far=[]}if(typeof timeline_parameters!=='undefined'){so_far=so_far.concat(Object.keys(timeline_parameters.timeline_variables[progress.order[progress.current_variable_set]]));var loc=Math.max(0,progress.current_location);if(loc==timeline_parameters.timeline.length){loc=loc-1}return timeline_parameters.timeline[loc].allTimelineVariablesNames(so_far)}if(typeof timeline_parameters=='undefined'){return so_far}};this.length=function(){var length=0;if(typeof timeline_parameters!=='undefined'){for(var i=0;i<timeline_parameters.timeline.length;i+=1){length+=timeline_parameters.timeline[i].length()}}else{return 1}return length};this.percentComplete=function(){var total_trials=this.length();var completed_trials=0;for(var i=0;i<timeline_parameters.timeline.length;i+=1){if(timeline_parameters.timeline[i].isComplete()){completed_trials+=timeline_parameters.timeline[i].length()}}return(completed_trials/total_trials*100)};this.reset=function(){progress.current_location=-1;progress.current_repetition=0;progress.current_variable_set=0;progress.current_iteration+=1;progress.done=false;this.setTimelineVariablesOrder();if(typeof timeline_parameters!='undefined'){for(var i=0;i<timeline_parameters.timeline.length;i+=1){timeline_parameters.timeline[i].reset()}}};this.end=function(){progress.done=true};this.endActiveNode=function(){if(typeof timeline_parameters=='undefined'){this.end();parent_node.end()}else{timeline_parameters.timeline[progress.current_location].endActiveNode()}};this.ID=function(){var id="";if(typeof parent_node=='undefined'){return "0."+progress.current_iteration}else{id+=parent_node.ID()+"-";id+=relative_id+"."+progress.current_iteration;return id}};this.activeID=function(){if(typeof timeline_parameters=='undefined'){return this.ID()}else{return timeline_parameters.timeline[progress.current_location].activeID()}};this.generatedData=function(){return jsPsych.data.getDataByTimelineNode(this.ID())};this.trialsOfType=function(type){if(typeof timeline_parameters=='undefined'){if(trial_parameters.type==type){return trial_parameters}else{return[]}}else{var trials=[];for(var i=0;i<timeline_parameters.timeline.length;i+=1){var t=timeline_parameters.timeline[i].trialsOfType(type);trials=trials.concat(t)}return trials}};this.insert=function(parameters){if(typeof timeline_parameters=='undefined'){console.error('Cannot add new trials to a trial-level node.')}else{timeline_parameters.timeline.push(new TimelineNode(Object.assign({},node_trial_data,parameters),self,timeline_parameters.timeline.length))}};var _construct=function(){parent_node=parent;if(typeof parent=='undefined'){relative_id=0}else{relative_id=relativeID}if((typeof parameters.timeline!=='undefined')||(typeof jsPsych.plugins[trial_type]=='function')){timeline_parameters={timeline:[],loop_function:parameters.loop_function,conditional_function:parameters.conditional_function,sample:parameters.sample,randomize_order:typeof parameters.randomize_order=='undefined'?false:parameters.randomize_order,repetitions:typeof parameters.repetitions=='undefined'?1:parameters.repetitions,timeline_variables:typeof parameters.timeline_variables=='undefined'?[{}]:parameters.timeline_variables,on_timeline_finish:parameters.on_timeline_finish,on_timeline_start:parameters.on_timeline_start};self.setTimelineVariablesOrder();var node_data=Object.assign({},parameters);delete node_data.timeline;delete node_data.conditional_function;delete node_data.loop_function;delete node_data.randomize_order;delete node_data.repetitions;delete node_data.timeline_variables;delete node_data.sample;delete node_data.on_timeline_start;delete node_data.on_timeline_finish;node_trial_data=node_data;for(var i=0;i<parameters.timeline.length;i+=1){var merged_parameters=Object.assign({},node_data,parameters.timeline[i]);if(typeof node_data.data=='object'&&typeof parameters.timeline[i].data=='object'){var merged_data=Object.assign({},node_data.data,parameters.timeline[i].data);merged_parameters.data=merged_data}timeline_parameters.timeline.push(new TimelineNode(merged_parameters,self,i))}}else{var trial_type=parameters.type;if(typeof trial_type=='undefined'){console.error('Trial level node is missing the "type" parameter. The parameters for the node are: '+JSON.stringify(parameters))}else if((typeof jsPsych.plugins[trial_type]=='undefined')&&(trial_type.toString().replace(/\s/g,'')!="function(){returntimeline.timelineVariable(varname);}")){console.error('No plugin loaded for trials of type "'+trial_type+'"')}trial_parameters=Object.assign({},parameters)}}()}function startExperiment(){loaded=true;if(opts.show_progress_bar===true){drawProgressBar(opts.message_progress_bar)}exp_start_time=new Date();timeline.advance();doTrial(timeline.trial())}function finishExperiment(){if(typeof timeline.end_message!=='undefined'){DOM_target.innerHTML=timeline.end_message}opts.on_finish(jsPsych.data.get())}function nextTrial(){if(paused){waiting=true;return}global_trial_index+=1;timeline.markCurrentTrialComplete();var complete=timeline.advance();if(opts.show_progress_bar===true&&opts.auto_update_progress_bar==true){updateProgressBar()}if(complete){finishExperiment();return}doTrial(timeline.trial())}function doTrial(trial){current_trial=trial;current_trial_finished=false;evaluateTimelineVariables(trial);evaluateFunctionParameters(trial);setDefaultValues(trial);jsPsych.internal.call_immediate=true;opts.on_trial_start(trial);if(typeof trial.on_start=='function'){trial.on_start(trial)}if(Array.isArray(trial.extensions)){for(var i=0;i<trial.extensions.length;i+=1){jsPsych.extensions[trial.extensions[i].type].on_start(current_trial.extensions[i].params)}}DOM_container.focus();DOM_target.scrollTop=0;if(typeof trial.css_classes!=='undefined'){if(!Array.isArray(trial.css_classes)&&typeof trial.css_classes=='string'){trial.css_classes=[trial.css_classes]}if(Array.isArray(trial.css_classes)){DOM_target.classList.add(...trial.css_classes)}}jsPsych.plugins[trial.type].trial(DOM_target,trial);if(typeof trial.on_load=='function'){trial.on_load()}if(Array.isArray(trial.extensions)){for(var i=0;i<trial.extensions.length;i+=1){jsPsych.extensions[trial.extensions[i].type].on_load(current_trial.extensions[i].params)}}jsPsych.internal.call_immediate=false}function evaluateTimelineVariables(trial){var keys=Object.keys(trial);for(var i=0;i<keys.length;i+=1){if(typeof trial[keys[i]]=="function"&&trial[keys[i]].toString().replace(/\s/g,'')=="function(){returntimeline.timelineVariable(varname);}"){trial[keys[i]]=trial[keys[i]].call()}if(typeof trial[keys[i]]=="object"&&trial[keys[i]]!==null){evaluateTimelineVariables(trial[keys[i]])}}}function evaluateFunctionParameters(trial){jsPsych.internal.call_immediate=true;if(typeof trial.type==='function'){trial.type=trial.type.call()}var keys=Object.keys(trial);for(var i=0;i<keys.length;i+=1){if(keys[i]!=='type'){if(typeof jsPsych.plugins.universalPluginParameters[keys[i]]!=='undefined'&&jsPsych.plugins.universalPluginParameters[keys[i]].type!==jsPsych.plugins.parameterType.FUNCTION){trial[keys[i]]=replaceFunctionsWithValues(trial[keys[i]],null)}if(typeof jsPsych.plugins[trial.type].info.parameters[keys[i]]!=='undefined'&&jsPsych.plugins[trial.type].info.parameters[keys[i]].type!==jsPsych.plugins.parameterType.FUNCTION){trial[keys[i]]=replaceFunctionsWithValues(trial[keys[i]],jsPsych.plugins[trial.type].info.parameters[keys[i]])}}}jsPsych.internal.call_immediate=false}function replaceFunctionsWithValues(obj,info){if(obj===null){return obj}else if(Array.isArray(obj)){for(var i=0;i<obj.length;i+=1){obj[i]=replaceFunctionsWithValues(obj[i],info)}}else if(typeof obj==='object'){var keys=Object.keys(obj);if(info==null||!info.nested){for(var i=0;i<keys.length;i+=1){obj[keys[i]]=replaceFunctionsWithValues(obj[keys[i]],null)}}else{for(var i=0;i<keys.length;i+=1){if(typeof info.nested[keys[i]]=='object'&&info.nested[keys[i]].type!==jsPsych.plugins.parameterType.FUNCTION){obj[keys[i]]=replaceFunctionsWithValues(obj[keys[i]],info.nested[keys[i]])}}}}else if(typeof obj==='function'){return obj()}return obj}function setDefaultValues(trial){for(var param in jsPsych.plugins[trial.type].info.parameters){if(jsPsych.plugins[trial.type].info.parameters[param].type==jsPsych.plugins.parameterType.COMPLEX){if(jsPsych.plugins[trial.type].info.parameters[param].array==true){trial[param].forEach(function(ip,i){for(var p in jsPsych.plugins[trial.type].info.parameters[param].nested){if(typeof trial[param][i][p]=='undefined'||trial[param][i][p]===null){if(typeof jsPsych.plugins[trial.type].info.parameters[param].nested[p].default=='undefined'){console.error('You must specify a value for the '+p+' parameter (nested in the '+param+' parameter) in the '+trial.type+' plugin.')}else{trial[param][i][p]=jsPsych.plugins[trial.type].info.parameters[param].nested[p].default}}}})}}else if(typeof trial[param]=='undefined'||trial[param]===null){if(typeof jsPsych.plugins[trial.type].info.parameters[param].default=='undefined'){console.error('You must specify a value for the '+param+' parameter in the '+trial.type+' plugin.')}else{trial[param]=jsPsych.plugins[trial.type].info.parameters[param].default}}}}function checkExclusions(exclusions,success,fail){var clear=true;if(typeof exclusions.min_width!=='undefined'||typeof exclusions.min_height!=='undefined'){var mw=typeof exclusions.min_width!=='undefined'?exclusions.min_width:0;var mh=typeof exclusions.min_height!=='undefined'?exclusions.min_height:0;var w=window.innerWidth;var h=window.innerHeight;if(w<mw||h<mh){clear=false;var interval=setInterval(function(){var w=window.innerWidth;var h=window.innerHeight;if(w<mw||h<mh){var msg='<p>Your browser window is too small to complete this experiment. Please maximize the size of your browser window. If your browser window is already maximized, you will not be able to complete this experiment.</p><p>The minimum width is '+mw+'px. Your current width is '+w+'px.</p><p>The minimum height is '+mh+'px. Your current height is '+h+'px.</p>';core.getDisplayElement().innerHTML=msg}else{clearInterval(interval);core.getDisplayElement().innerHTML='';checkExclusions(exclusions,success,fail)}},100);return;}}if(typeof exclusions.audio!=='undefined'&&exclusions.audio){if(window.hasOwnProperty('AudioContext')||window.hasOwnProperty('webkitAudioContext')){}else{clear=false;var msg='<p>Your browser does not support the WebAudio API, which means that you will not be able to complete the experiment.</p><p>Browsers that support the WebAudio API include Chrome, Firefox, Safari, and Edge.</p>';core.getDisplayElement().innerHTML=msg;fail();return}}if(clear){success()}}function drawProgressBar(msg){document.querySelector('.jspsych-display-element').insertAdjacentHTML('afterbegin','<div id="jspsych-progressbar-container"><span>'+msg+'</span><div id="jspsych-progressbar-outer"><div id="jspsych-progressbar-inner"></div></div></div>')}function updateProgressBar(){var progress=jsPsych.progress().percent_complete;core.setProgressBar(progress/100)}var progress_bar_amount=0;core.setProgressBar=function(proportion_complete){proportion_complete=Math.max(Math.min(1,proportion_complete),0);document.querySelector('#jspsych-progressbar-inner').style.width=(proportion_complete*100)+"%";progress_bar_amount=proportion_complete};core.getProgressBarCompleted=function(){return progress_bar_amount};document.documentElement.setAttribute('jspsych','present');return core})();jsPsych.internal=(function(){var module={};module.call_immediate=false;return module})();jsPsych.plugins=(function(){var module={};module.parameterType={BOOL:0,STRING:1,INT:2,FLOAT:3,FUNCTION:4,KEY:5,SELECT:6,HTML_STRING:7,IMAGE:8,AUDIO:9,VIDEO:10,OBJECT:11,COMPLEX:12,TIMELINE:13};module.universalPluginParameters={data:{type:module.parameterType.OBJECT,pretty_name:'Data',default:{},description:'Data to add to this trial (key-value pairs)'},on_start:{type:module.parameterType.FUNCTION,pretty_name:'On start',default:function(){return},description:'Function to execute when trial begins'},on_finish:{type:module.parameterType.FUNCTION,pretty_name:'On finish',default:function(){return},description:'Function to execute when trial is finished'},on_load:{type:module.parameterType.FUNCTION,pretty_name:'On load',default:function(){return},description:'Function to execute after the trial has loaded'},post_trial_gap:{type:module.parameterType.INT,pretty_name:'Post trial gap',default:null,description:'Length of gap between the end of this trial and the start of the next trial'},css_classes:{type:module.parameterType.STRING,pretty_name:'Custom CSS classes',default:null,description:'A list of CSS classes to add to the jsPsych display element for the duration of this trial'}};return module})();jsPsych.extensions=(function(){return{}})();jsPsych.data=(function(){var module={};var allData=DataCollection();var interactionData=DataCollection();var dataProperties={};var query_string;function DataCollection(data){var data_collection={};var trials=typeof data==='undefined'?[]:data;data_collection.push=function(new_data){trials.push(new_data);return data_collection};data_collection.join=function(other_data_collection){trials=trials.concat(other_data_collection.values());return data_collection};data_collection.top=function(){if(trials.length<=1){return data_collection}else{return DataCollection([trials[trials.length-1]])}};data_collection.first=function(n){if(typeof n=='undefined'){n=1}if(n<1){throw `You must query with a positive nonzero integer. Please use a
               different value for n.`}if(trials.length==0){return DataCollection([])}if(n>trials.length){n=trials.length}return DataCollection(trials.slice(0,n))};data_collection.last=function(n){if(typeof n=='undefined'){n=1}if(n<1){throw `You must query with a positive nonzero integer. Please use a
               different value for n.`}if(trials.length==0){return DataCollection([])}if(n>trials.length){n=trials.length}return DataCollection(trials.slice(trials.length-n,trials.length))};data_collection.values=function(){return trials};data_collection.count=function(){return trials.length};data_collection.readOnly=function(){return DataCollection(jsPsych.utils.deepCopy(trials))};data_collection.addToAll=function(properties){for(var i=0;i<trials.length;i+=1){for(var key in properties){trials[i][key]=properties[key]}}return data_collection};data_collection.addToLast=function(properties){if(trials.length!=0){for(var key in properties){trials[trials.length-1][key]=properties[key]}}return data_collection};data_collection.filter=function(filters){if(!Array.isArray(filters)){var f=jsPsych.utils.deepCopy([filters])}else{var f=jsPsych.utils.deepCopy(filters)}var filtered_data=[];for(var x=0;x<trials.length;x+=1){var keep=false;for(var i=0;i<f.length;i+=1){var match=true;var keys=Object.keys(f[i]);for(var k=0;k<keys.length;k+=1){if(typeof trials[x][keys[k]]!=='undefined'&&trials[x][keys[k]]==f[i][keys[k]]){}else{match=false}}if(match){keep=true;break}}if(keep){filtered_data.push(trials[x])}}var out=DataCollection(filtered_data);return out};data_collection.filterCustom=function(fn){var included=[];for(var i=0;i<trials.length;i+=1){if(fn(trials[i])){included.push(trials[i])}}return DataCollection(included)};data_collection.select=function(column){var values=[];for(var i=0;i<trials.length;i+=1){if(typeof trials[i][column]!=='undefined'){values.push(trials[i][column])}}var out=DataColumn();out.values=values;return out};data_collection.ignore=function(columns){if(!Array.isArray(columns)){columns=[columns]}var o=jsPsych.utils.deepCopy(trials);for(var i=0;i<o.length;i+=1){for(var j in columns){delete o[i][columns[j]]}}return DataCollection(o)};data_collection.uniqueNames=function(){var names=[];for(var i=0;i<trials.length;i+=1){var keys=Object.keys(trials[i]);for(var j=0;j<keys.length;j+=1){if(!names.includes(keys[j])){names.push(keys[j])}}}return names};data_collection.csv=function(){return JSON2CSV(trials)};data_collection.json=function(pretty){if(pretty){return JSON.stringify(trials,null,'\t')}return JSON.stringify(trials)};data_collection.localSave=function(format,filename){var data_string;if(format=='JSON'||format=='json'){data_string=data_collection.json()}else if(format=='CSV'||format=='csv'){data_string=data_collection.csv()}else{throw new Error('Invalid format specified for localSave. Must be "JSON" or "CSV".')}saveTextToFile(data_string,filename)};return data_collection}function DataColumn(){var data_column={};data_column.values=[];data_column.sum=function(){var s=0;for(var i=0;i<data_column.values.length;i+=1){s+=data_column.values[i]}return s};data_column.mean=function(){return data_column.sum()/data_column.count()};data_column.median=function(){if(data_column.values.length==0){return undefined};var numbers=data_column.values.slice(0).sort(function(a,b){return a-b});var middle=Math.floor(numbers.length/2);var isEven=numbers.length%2===0;return isEven?(numbers[middle]+numbers[middle-1])/2:numbers[middle]};data_column.min=function(){return Math.min.apply(null,data_column.values)};data_column.max=function(){return Math.max.apply(null,data_column.values)};data_column.count=function(){return data_column.values.length};data_column.variance=function(){var mean=data_column.mean();var sum_square_error=0;for(var i=0;i<data_column.values.length;i+=1){sum_square_error+=Math.pow(data_column.values[i]-mean,2)}var mse=sum_square_error/(data_column.values.length-1);return mse};data_column.sd=function(){var mse=data_column.variance();var rmse=Math.sqrt(mse);return rmse};data_column.frequencies=function(){var unique={};for(var i=0;i<data_column.values.length;i+=1){var v=data_column.values[i];if(typeof unique[v]=='undefined'){unique[v]=1}else{unique[v]+=1}}return unique};data_column.all=function(eval_fn){for(var i=0;i<data_column.values.length;i+=1){if(!eval_fn(data_column.values[i])){return false}}return true};data_column.subset=function(eval_fn){var out=[];for(var i=0;i<data_column.values.length;i+=1){if(eval_fn(data_column.values[i])){out.push(data_column.values[i])}}var o=DataColumn();o.values=out;return o};return data_column}module.reset=function(){allData=DataCollection();interactionData=DataCollection()};module.get=function(){return allData};module.getInteractionData=function(){return interactionData};module.write=function(data_object){var progress=jsPsych.progress();var trial=jsPsych.currentTrial();var default_data={'trial_type':trial.type,'trial_index':progress.current_trial_global,'time_elapsed':jsPsych.totalTime(),'internal_node_id':jsPsych.currentTimelineNodeID()};var ext_data_object=Object.assign({},data_object,trial.data,default_data,dataProperties);allData.push(ext_data_object)};module.addProperties=function(properties){allData.addToAll(properties);dataProperties=Object.assign({},dataProperties,properties)};module.addDataToLastTrial=function(data){allData.addToLast(data)};module.getDataByTimelineNode=function(node_id){var data=allData.filterCustom(function(x){return x.internal_node_id.slice(0,node_id.length)===node_id});return data};module.getLastTrialData=function(){return allData.top()};module.getLastTimelineData=function(){var lasttrial=module.getLastTrialData();var node_id=lasttrial.select('internal_node_id').values[0];if(typeof node_id==='undefined'){return DataCollection()}else{var parent_node_id=node_id.substr(0,node_id.lastIndexOf('-'));var lastnodedata=module.getDataByTimelineNode(parent_node_id);return lastnodedata}};module.displayData=function(format){format=(typeof format==='undefined')?"json":format.toLowerCase();if(format!="json"&&format!="csv"){console.log('Invalid format declared for displayData function. Using json as default.');format="json"}var data_string;if(format=='json'){data_string=allData.json(true);}else{data_string=allData.csv()}var display_element=jsPsych.getDisplayElement();display_element.innerHTML='<pre id="jspsych-data-display"></pre>';document.getElementById('jspsych-data-display').textContent=data_string};module.urlVariables=function(){if(typeof query_string=='undefined'){query_string=getQueryString()}return query_string};module.getURLVariable=function(whichvar){if(typeof query_string=='undefined'){query_string=getQueryString()}return query_string[whichvar]};module.createInteractionListeners=function(){window.addEventListener('blur',function(){var data={event:'blur',trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};interactionData.push(data);jsPsych.initSettings().on_interaction_data_update(data)});window.addEventListener('focus',function(){var data={event:'focus',trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};interactionData.push(data);jsPsych.initSettings().on_interaction_data_update(data)});function fullscreenchange(){var type=(document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen||document.fullscreenElement)?'fullscreenenter':'fullscreenexit';var data={event:type,trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};interactionData.push(data);jsPsych.initSettings().on_interaction_data_update(data)}document.addEventListener('fullscreenchange',fullscreenchange);document.addEventListener('mozfullscreenchange',fullscreenchange);document.addEventListener('webkitfullscreenchange',fullscreenchange)};module._customInsert=function(data){allData=DataCollection(data)};module._fullreset=function(){module.reset();dataProperties={}};function saveTextToFile(textstr,filename){var blobToSave=new Blob([textstr],{type:'text/plain'});var blobURL="";if(typeof window.webkitURL!=='undefined'){blobURL=window.webkitURL.createObjectURL(blobToSave)}else{blobURL=window.URL.createObjectURL(blobToSave)}var display_element=jsPsych.getDisplayElement();display_element.insertAdjacentHTML('beforeend','<a id="jspsych-download-as-text-link" style="display:none;" download="'+filename+'" href="'+blobURL+'">click to download</a>');document.getElementById('jspsych-download-as-text-link').click()}function JSON2CSV(objArray){var array=typeof objArray!='object'?JSON.parse(objArray):objArray;var line='';var result='';var columns=[];var i=0;for(var j=0;j<array.length;j+=1){for(var key in array[j]){var keyString=key+"";keyString='"'+keyString.replace(/"/g,'""')+'",';if(!columns.includes(key)){columns[i]=key;line+=keyString;i+=1}}}line=line.slice(0,-1);result+=line+'\r\n';for(var i=0;i<array.length;i+=1){var line='';for(var j=0;j<columns.length;j+=1){var value=(typeof array[i][columns[j]]==='undefined')?'':array[i][columns[j]];if(typeof value=='object'){value=JSON.stringify(value)}var valueString=value+"";line+='"'+valueString.replace(/"/g,'""')+'",'}line=line.slice(0,-1);result+=line+'\r\n'}return result}function getQueryString(){var a=window.location.search.substr(1).split('&');if(a==""){return{}}var b={};for(var i=0;i<a.length;i+=1){var p=a[i].split('=',2);if(p.length==1){b[p[0]]=""}else{b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "))}}return b}return module})();jsPsych.turk=(function(){var module={};module.turkInfo=function(){var turk={};var param=function(url,name){name=name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");var regexS="[\\?&]"+name+"=([^&#]*)";var regex=new RegExp(regexS);var results=regex.exec(url);return(results==null)?"":results[1]};var src=param(window.location.href,"assignmentId")?window.location.href:document.referrer;var keys=["assignmentId","hitId","workerId","turkSubmitTo"];keys.map(function(key){turk[key]=unescape(param(src,key))});turk.previewMode=(turk.assignmentId=="ASSIGNMENT_ID_NOT_AVAILABLE");turk.outsideTurk=(!turk.previewMode&&turk.hitId===""&&turk.assignmentId==""&&turk.workerId=="");turk_info=turk;return turk};module.submitToTurk=function(data){var turkInfo=jsPsych.turk.turkInfo();var assignmentId=turkInfo.assignmentId;var turkSubmitTo=turkInfo.turkSubmitTo;if(!assignmentId||!turkSubmitTo){return}var dataString=[];for(var key in data){if(data.hasOwnProperty(key)){dataString.push(key+"="+escape(data[key]))}}dataString.push("assignmentId="+assignmentId);var url=turkSubmitTo+"/mturk/externalSubmit?"+dataString.join("&");window.location.href=url};return module})();jsPsych.randomization=(function(){var module={};module.repeat=function(array,repetitions,unpack){var arr_isArray=Array.isArray(array);var rep_isArray=Array.isArray(repetitions);if(!arr_isArray){if(!rep_isArray){array=[array];repetitions=[repetitions]}else{repetitions=[repetitions[0]];console.log('Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.')}}else{if(!rep_isArray){var reps=[];for(var i=0;i<array.length;i+=1){reps.push(repetitions)}repetitions=reps}else{if(array.length!=repetitions.length){console.warning('Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected.');if(repetitions.length<array.length){var reps=[];for(var i=0;i<array.length;i+=1){reps.push(repetitions)}repetitions=reps}else{repetitions=repetitions.slice(0,array.length)}}}}var allsamples=[];for(var i=0;i<array.length;i+=1){for(var j=0;j<repetitions[i];j+=1){if(array[i]==null||typeof array[i]!='object'){allsamples.push(array[i])}else{allsamples.push(Object.assign({},array[i]))}}}var out=shuffle(allsamples);if(unpack){out=unpackArray(out)}return out};module.shuffle=function(arr){if(!Array.isArray(arr)){console.error('Argument to jsPsych.randomization.shuffle() must be an array.')}return shuffle(arr)};module.shuffleNoRepeats=function(arr,equalityTest){if(!Array.isArray(arr)){console.error('First argument to jsPsych.randomization.shuffleNoRepeats() must be an array.')}if(typeof equalityTest!=='undefined'&&typeof equalityTest!=='function'){console.error('Second argument to jsPsych.randomization.shuffleNoRepeats() must be a function.')}if(typeof equalityTest=='undefined'){equalityTest=function(a,b){if(a===b){return true}else{return false}}}var random_shuffle=shuffle(arr);for(var i=0;i<random_shuffle.length-1;i+=1){if(equalityTest(random_shuffle[i],random_shuffle[i+1])){var random_pick=Math.floor(Math.random()*(random_shuffle.length-2))+1;while(equalityTest(random_shuffle[i+1],random_shuffle[random_pick])||(equalityTest(random_shuffle[i+1],random_shuffle[random_pick+1])||equalityTest(random_shuffle[i+1],random_shuffle[random_pick-1]))){random_pick=Math.floor(Math.random()*(random_shuffle.length-2))+1}var new_neighbor=random_shuffle[random_pick];random_shuffle[random_pick]=random_shuffle[i+1];random_shuffle[i+1]=new_neighbor}}return random_shuffle};module.shuffleAlternateGroups=function(arr_groups,random_group_order){if(typeof random_group_order=='undefined'){random_group_order=false}var n_groups=arr_groups.length;if(n_groups==1){console.warn('jsPsych.randomization.shuffleAlternateGroups was called with only one group. Defaulting to simple shuffle.');return(module.shuffle(arr_groups[0]))}var group_order=[];for(var i=0;i<n_groups;i+=1){group_order.push(i)}if(random_group_order){group_order=module.shuffle(group_order)}var randomized_groups=[];var min_length=null;for(var i=0;i<n_groups;i+=1){min_length=min_length===null?arr_groups[i].length:Math.min(min_length,arr_groups[i].length);randomized_groups.push(module.shuffle(arr_groups[i]))}var out=[];for(var i=0;i<min_length;i+=1){for(var j=0;j<group_order.length;j+=1){out.push(randomized_groups[group_order[j]][i])}}return out};module.sampleWithoutReplacement=function(arr,size){if(!Array.isArray(arr)){console.error("First argument to jsPsych.randomization.sampleWithoutReplacement() must be an array")}if(size>arr.length){console.error("Cannot take a sample larger than the size of the set of items to sample.")}return jsPsych.randomization.shuffle(arr).slice(0,size)};module.sampleWithReplacement=function(arr,size,weights){if(!Array.isArray(arr)){console.error("First argument to jsPsych.randomization.sampleWithReplacement() must be an array")}var normalized_weights=[];if(typeof weights!=='undefined'){if(weights.length!==arr.length){console.error('The length of the weights array must equal the length of the array to be sampled from.')}var weight_sum=0;for(var i=0;i<weights.length;i+=1){weight_sum+=weights[i]}for(var i=0;i<weights.length;i+=1){normalized_weights.push(weights[i]/weight_sum)}}else{for(var i=0;i<arr.length;i+=1){normalized_weights.push(1/arr.length)}}var cumulative_weights=[normalized_weights[0]];for(var i=1;i<normalized_weights.length;i+=1){cumulative_weights.push(normalized_weights[i]+cumulative_weights[i-1])}var samp=[];for(var i=0;i<size;i+=1){var rnd=Math.random();var index=0;while(rnd>cumulative_weights[index]){index+=1}samp.push(arr[index])}return samp};module.factorial=function(factors,repetitions,unpack){var factorNames=Object.keys(factors);var factor_combinations=[];for(var i=0;i<factors[factorNames[0]].length;i+=1){factor_combinations.push({});factor_combinations[i][factorNames[0]]=factors[factorNames[0]][i]}for(var i=1;i<factorNames.length;i+=1){var toAdd=factors[factorNames[i]];var n=factor_combinations.length;for(var j=0;j<n;j+=1){var base=factor_combinations[j];for(var k=0;k<toAdd.length;k+=1){var newpiece={};newpiece[factorNames[i]]=toAdd[k];factor_combinations.push(Object.assign({},base,newpiece))}}factor_combinations.splice(0,n)}repetitions=(typeof repetitions==='undefined')?1:repetitions;var with_repetitions=module.repeat(factor_combinations,repetitions,unpack);return with_repetitions};module.randomID=function(length){var result='';var length=(typeof length=='undefined')?32:length;var chars='0123456789abcdefghjklmnopqrstuvwxyz';for(var i=0;i<length;i+=1){result+=chars[Math.floor(Math.random()*chars.length)]}return result};function unpackArray(array){var out={};for(var i=0;i<array.length;i+=1){var keys=Object.keys(array[i]);for(var k=0;k<keys.length;k+=1){if(typeof out[keys[k]]==='undefined'){out[keys[k]]=[]}out[keys[k]].push(array[i][keys[k]])}}return out}function shuffle(array){var copy_array=array.slice(0);var m=copy_array.length,t,i;while(m){i=Math.floor(Math.random()*m--);t=copy_array[m];copy_array[m]=copy_array[i];copy_array[i]=t}return copy_array}return module})();jsPsych.pluginAPI=(function(){var module={};var keyboard_listeners=[];var held_keys={};var root_keydown_listener=function(e){for(var i=0;i<keyboard_listeners.length;i+=1){keyboard_listeners[i].fn(e)}held_keys[e.key]=true};var root_keyup_listener=function(e){held_keys[e.key]=false};module.reset=function(root_element){keyboard_listeners=[];held_keys={};root_element.removeEventListener('keydown',root_keydown_listener);root_element.removeEventListener('keyup',root_keyup_listener)};module.createKeyboardEventListeners=function(root_element){root_element.addEventListener('keydown',root_keydown_listener);root_element.addEventListener('keyup',root_keyup_listener)};module.getKeyboardResponse=function(parameters){parameters.rt_method=(typeof parameters.rt_method==='undefined')?'performance':parameters.rt_method;if(parameters.rt_method!='performance'&&parameters.rt_method!='audio'){console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "performance" method.');parameters.rt_method='performance'}var start_time;if(parameters.rt_method=='performance'){start_time=performance.now()}else if(parameters.rt_method==='audio'){start_time=parameters.audio_context_start_time}var case_sensitive=(typeof jsPsych.initSettings().case_sensitive_responses==='undefined')?false:jsPsych.initSettings().case_sensitive_responses;var listener_id;var listener_function=function(e){var key_time;if(parameters.rt_method=='performance'){key_time=performance.now()}else if(parameters.rt_method==='audio'){key_time=parameters.audio_context.currentTime}var rt=key_time-start_time;var minimum_valid_rt=parameters.minimum_valid_rt;if(!minimum_valid_rt){minimum_valid_rt=jsPsych.initSettings().minimum_valid_rt||0}if(rt<minimum_valid_rt){return}var valid_response=false;if(typeof parameters.valid_responses==='undefined'){valid_response=true}else if(parameters.valid_responses==jsPsych.ALL_KEYS){valid_response=true}else if(parameters.valid_responses!=jsPsych.NO_KEYS){if(parameters.valid_responses.includes(e.key)){valid_response=true}if(!case_sensitive){var valid_lower=parameters.valid_responses.map(function(v){return v.toLowerCase()});var key_lower=e.key.toLowerCase();if(valid_lower.includes(key_lower)){valid_response=true}}}if(((typeof parameters.allow_held_key==='undefined')||!parameters.allow_held_key)&&valid_response){if(typeof held_keys[e.key]!=='undefined'&&held_keys[e.key]==true){valid_response=false}if(!case_sensitive&&typeof held_keys[e.key.toLowerCase()]!=='undefined'&&held_keys[e.key.toLowerCase()]==true){valid_response=false}}if(valid_response){e.preventDefault();var key=e.key;if(!case_sensitive){key=key.toLowerCase()}parameters.callback_function({key:key,rt:rt});if(keyboard_listeners.includes(listener_id)){if(!parameters.persist){module.cancelKeyboardResponse(listener_id)}}}};listener_id={type:'keydown',fn:listener_function};keyboard_listeners.push(listener_id);return listener_id};module.cancelKeyboardResponse=function(listener){if(keyboard_listeners.includes(listener)){keyboard_listeners.splice(keyboard_listeners.indexOf(listener),1)}};module.cancelAllKeyboardResponses=function(){keyboard_listeners=[]};module.convertKeyCharacterToKeyCode=function(character){console.warn('Warning: The jsPsych.pluginAPI.convertKeyCharacterToKeyCode function will be removed in future jsPsych releases. We recommend removing this function and using strings to identify/compare keys.');var code;character=character.toLowerCase();if(typeof keylookup[character]!=='undefined'){code=keylookup[character]}return code};module.convertKeyCodeToKeyCharacter=function(code){console.warn('Warning: The jsPsych.pluginAPI.convertKeyCodeToKeyCharacter function will be removed in future jsPsych releases. We recommend removing this function and using strings to identify/compare keys.');for(var i in Object.keys(keylookup)){if(keylookup[Object.keys(keylookup)[i]]==code){return Object.keys(keylookup)[i]}}return undefined};module.compareKeys=function(key1,key2){if(Number.isFinite(key1)||Number.isFinite(key2)){if(typeof key1=='string'){key1=module.convertKeyCharacterToKeyCode(key1)}if(typeof key2=='string'){key2=module.convertKeyCharacterToKeyCode(key2)}return key1==key2}else if(typeof key1==='string'&&typeof key2==='string'){var case_sensitive=(typeof jsPsych.initSettings().case_sensitive_responses==='undefined')?false:jsPsych.initSettings().case_sensitive_responses;if(case_sensitive){return key1==key2}else{return key1.toLowerCase()==key2.toLowerCase()}}else if(key1===null&&(typeof key2==='string'||Number.isFinite(key2))||key2===null&&(typeof key1==='string'||Number.isFinite(key1))){return false}else if(key1===null&&key2===null){return true}else{console.error('Error in jsPsych.pluginAPI.compareKeys: arguments must be numeric key codes, key strings, or null.');return undefined}};var keylookup={'backspace':8,'tab':9,'enter':13,'shift':16,'ctrl':17,'alt':18,'pause':19,'capslock':20,'esc':27,'space':32,'spacebar':32,' ':32,'pageup':33,'pagedown':34,'end':35,'home':36,'leftarrow':37,'uparrow':38,'rightarrow':39,'downarrow':40,'insert':45,'delete':46,'0':48,'1':49,'2':50,'3':51,'4':52,'5':53,'6':54,'7':55,'8':56,'9':57,'a':65,'b':66,'c':67,'d':68,'e':69,'f':70,'g':71,'h':72,'i':73,'j':74,'k':75,'l':76,'m':77,'n':78,'o':79,'p':80,'q':81,'r':82,'s':83,'t':84,'u':85,'v':86,'w':87,'x':88,'y':89,'z':90,'0numpad':96,'1numpad':97,'2numpad':98,'3numpad':99,'4numpad':100,'5numpad':101,'6numpad':102,'7numpad':103,'8numpad':104,'9numpad':105,'multiply':106,'plus':107,'minus':109,'decimal':110,'divide':111,'f1':112,'f2':113,'f3':114,'f4':115,'f5':116,'f6':117,'f7':118,'f8':119,'f9':120,'f10':121,'f11':122,'f12':123,'=':187,',':188,'.':190,'/':191,'`':192,'[':219,'\\':220,']':221};var timeout_handlers=[];module.setTimeout=function(callback,delay){var handle=setTimeout(callback,delay);timeout_handlers.push(handle);return handle};module.clearAllTimeouts=function(){for(var i=0;i<timeout_handlers.length;i+=1){clearTimeout(timeout_handlers[i])}timeout_handlers=[]};var video_buffers={};module.getVideoBuffer=function(videoID){return video_buffers[videoID]};var context=null;var audio_buffers=[];module.initAudio=function(){context=(jsPsych.initSettings().use_webaudio===true)?jsPsych.webaudio_context:null};module.audioContext=function(){if(context!==null){if(context.state!=='running'){context.resume()}}return context};module.getAudioBuffer=function(audioID){return new Promise(function(resolve,reject){if(typeof audio_buffers[audioID]=='undefined'||audio_buffers[audioID]=='tmp'){function complete(){resolve(audio_buffers[audioID])}function error(e){reject(e.error)}module.preloadAudio([audioID],complete,function(){},error)}else{resolve(audio_buffers[audioID])}})};var preloads=[];var preload_requests=[];var img_cache={};module.preloadAudio=function(files,callback_complete,callback_load,callback_error){files=jsPsych.utils.flatten(files);files=jsPsych.utils.unique(files);var n_loaded=0;var loadfn=(typeof callback_load==='undefined')?function(){}:callback_load;var finishfn=(typeof callback_complete==='undefined')?function(){}:callback_complete;var errorfn=(typeof callback_error==='undefined')?function(){}:callback_error;if(files.length==0){finishfn();return}function load_audio_file_webaudio(source,count){count=count||1;var request=new XMLHttpRequest();request.open('GET',source,true);request.responseType='arraybuffer';request.onload=function(){context.decodeAudioData(request.response,function(buffer){audio_buffers[source]=buffer;n_loaded+=1;loadfn(source);if(n_loaded==files.length){finishfn()}},function(e){errorfn({source:source,error:e})})};request.onerror=function(e){var err=e;if(this.status==404){err="404"}errorfn({source:source,error:err})};request.onloadend=function(e){if(this.status==404){errorfn({source:source,error:"404"})}};request.send();preload_requests.push(request)}function load_audio_file_html5audio(source,count){count=count||1;var audio=new Audio();audio.addEventListener('canplaythrough',function handleCanPlayThrough(){audio_buffers[source]=audio;n_loaded+=1;loadfn(source);if(n_loaded==files.length){finishfn()}audio.removeEventListener('canplaythrough',handleCanPlayThrough)});audio.addEventListener('error',function handleError(e){errorfn({source:audio.src,error:e});audio.removeEventListener('error',handleError)});audio.addEventListener('abort',function handleAbort(e){errorfn({source:audio.src,error:e});audio.removeEventListener('abort',handleAbort)});audio.src=source;preload_requests.push(audio)}for(var i=0;i<files.length;i+=1){var bufferID=files[i];if(typeof audio_buffers[bufferID]!=='undefined'){n_loaded+=1;loadfn(bufferID);if(n_loaded==files.length){finishfn()}}else{audio_buffers[bufferID]='tmp';if(module.audioContext()!==null){load_audio_file_webaudio(bufferID)}else{load_audio_file_html5audio(bufferID)}}}};module.preloadImages=function(images,callback_complete,callback_load,callback_error){images=jsPsych.utils.flatten(images);images=jsPsych.utils.unique(images);var n_loaded=0;var finishfn=(typeof callback_complete==='undefined')?function(){}:callback_complete;var loadfn=(typeof callback_load==='undefined')?function(){}:callback_load;var errorfn=(typeof callback_error==='undefined')?function(){}:callback_error;if(images.length===0){finishfn();return}function preload_image(source){var img=new Image();img.onload=function(){n_loaded+=1;loadfn(img.src);if(n_loaded===images.length){finishfn()}};img.onerror=function(e){errorfn({source:img.src,error:e})};img.src=source;img_cache[source]=img;preload_requests.push(img)}for(var i=0;i<images.length;i+=1){preload_image(images[i])}};module.preloadVideo=function(video,callback_complete,callback_load,callback_error){video=jsPsych.utils.flatten(video);video=jsPsych.utils.unique(video);var n_loaded=0;var finishfn=!callback_complete?function(){}:callback_complete;var loadfn=!callback_load?function(){}:callback_load;var errorfn=(typeof callback_error==='undefined')?function(){}:callback_error;if(video.length===0){finishfn();return}function preload_video(source,count){count=count||1;var request=new XMLHttpRequest();request.open('GET',source,true);request.responseType='blob';request.onload=function(){if(this.status===200||this.status===0){var videoBlob=this.response;video_buffers[source]=URL.createObjectURL(videoBlob);n_loaded+=1;loadfn(source);if(n_loaded===video.length){finishfn()}}};request.onerror=function(e){var err=e;if(this.status==404){err="404"}errorfn({source:source,error:err})};request.onloadend=function(e){if(this.status==404){errorfn({source:source,error:"404"})}};request.send();preload_requests.push(request)}for(var i=0;i<video.length;i+=1){preload_video(video[i])}};module.registerPreload=function(plugin_name,parameter,media_type){if(['audio','image','video'].indexOf(media_type)===-1){console.error('Invalid media_type parameter for jsPsych.pluginAPI.registerPreload. Please check the plugin file.')}var preload={plugin:plugin_name,parameter:parameter,media_type:media_type};preloads.push(preload)};module.getAutoPreloadList=function(timeline_description){function getTrialsOfTypeFromTimelineDescription(td,target_type,inherited_type){var trials=[];for(var i=0;i<td.length;i+=1){var node=td[i];if(Array.isArray(node.timeline)){if(typeof node.type!=='undefined'){inherited_type=node.type}trials=trials.concat(getTrialsOfTypeFromTimelineDescription(node.timeline,target_type,inherited_type))}else{if(typeof node.type!=='undefined'&&node.type==target_type){trials.push(node)}if(typeof node.type=='undefined'&&inherited_type==target_type){trials.push(Object.assign({},{type:target_type},node))}}}return trials}if(typeof timeline_description=='undefined'){timeline_description=jsPsych.initSettings().timeline}var images=[];var audio=[];var video=[];for(var i=0;i<preloads.length;i+=1){var type=preloads[i].plugin;var param=preloads[i].parameter;var media=preloads[i].media_type;var trials=getTrialsOfTypeFromTimelineDescription(timeline_description,type);for(var j=0;j<trials.length;j+=1){if(typeof trials[j][param]=='undefined'){console.warn("jsPsych failed to auto preload one or more files:");console.warn("no parameter called "+param+" in plugin "+type)}else if(typeof trials[j][param]!=='function'){if(media==='image'){images=images.concat(jsPsych.utils.flatten([trials[j][param]]))}else if(media==='audio'){audio=audio.concat(jsPsych.utils.flatten([trials[j][param]]))}else if(media==='video'){video=video.concat(jsPsych.utils.flatten([trials[j][param]]))}}}}images=jsPsych.utils.unique(jsPsych.utils.flatten(images));audio=jsPsych.utils.unique(jsPsych.utils.flatten(audio));video=jsPsych.utils.unique(jsPsych.utils.flatten(video));images=images.filter(function(x){return x!=false&&x!=null});audio=audio.filter(function(x){return x!=false&&x!=null});video=video.filter(function(x){return x!=false&&x!=null});return{images,audio,video}};module.cancelPreloads=function(){for(var i=0;i<preload_requests.length;i+=1){preload_requests[i].onload=function(){};preload_requests[i].onerror=function(){};preload_requests[i].oncanplaythrough=function(){};preload_requests[i].onabort=function(){}}preload_requests=[]};module.hardware=function hardware(mess){var jspsychEvt=new CustomEvent('jspsych',{detail:mess});document.dispatchEvent(jspsychEvt);};module.hardwareConnected=false;document.addEventListener("jspsych-activate",function(evt){module.hardwareConnected=true});return module})();jsPsych.utils=(function(){var module={};module.flatten=function(arr,out){out=(typeof out==='undefined')?[]:out;for(var i=0;i<arr.length;i+=1){if(Array.isArray(arr[i])){module.flatten(arr[i],out)}else{out.push(arr[i])}}return out};module.unique=function(arr){var out=[];for(var i=0;i<arr.length;i+=1){if(arr.indexOf(arr[i])==i){out.push(arr[i])}}return out};module.deepCopy=function(obj){if(!obj){return obj}var out;if(Array.isArray(obj)){out=[];for(var i=0;i<obj.length;i+=1){out.push(module.deepCopy(obj[i]))}return out}else if(typeof obj==='object'){out={};for(var key in obj){if(obj.hasOwnProperty(key)){out[key]=module.deepCopy(obj[key])}}return out}else{return obj}};return module})();if(typeof Object.assign!='function'){Object.assign=function(target,varArgs){'use strict';if(target==null){throw new TypeError('Cannot convert undefined or null to object')}var to=Object(target);for(var index=1;index<arguments.length;index+=1){var nextSource=arguments[index];if(nextSource!=null){for(var nextKey in nextSource){if(Object.prototype.hasOwnProperty.call(nextSource,nextKey)){to[nextKey]=nextSource[nextKey]}}}}return to}}if(!Array.prototype.includes){Array.prototype.includes=function(searchElement ){'use strict';if(this==null){throw new TypeError('Array.prototype.includes called on null or undefined')}var O=Object(this);var len=parseInt(O.length,10)||0;if(len===0){return false}var n=parseInt(arguments[1],10)||0;var k;if(n>=0){k=n}else{k=len+n;if(k<0){k=0}}var currentElement;while(k<len){currentElement=O[k];if(searchElement===currentElement||(searchElement!==searchElement&&currentElement!==currentElement)){return true}k+=1}return false}}if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==='[object Array]'}}
