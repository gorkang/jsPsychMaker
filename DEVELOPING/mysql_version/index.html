<!DOCTYPE html>
<html>

<head>
  <meta charset='UTF-8'>
  <title>Experimentos CSCN</title>

  <link rel="stylesheet" href="jsPsych-6/css/jspsych.css">
</head>

<body id="general_body" style="height:100%;">

  <!-- Libreria principal JsPsych -->
  <script src="jsPsych-6/jspsych.js"></script>
  <!-- esentials plugins -->
  <script src="jsPsych-6/plugins/jspsych-call-function.js"></script>
  <script src="jsPsych-6/plugins/jspsych-preload.js"></script>
  <!-- Protocol Plugins -->
  <script src="jsPsych-6/plugins/jspsych-image-button-response.js"></script>
  <script src="jsPsych-6/plugins/jspsych-fullscreen.js"></script>
  <script src="jsPsych-6/plugins/jspsych-instructions.js"></script>
  <script src="jsPsych-6/plugins/jspsych-html-button-response.js"></script>
  <script src="jsPsych-6/plugins/jspsych-survey-text.js"></script>
  <script src="jsPsych-6/plugins/jspsych-survey-multi-choice-vertical.js"></script>
  <script src="jsPsych-6/plugins/jspsych-html-slider-response.js"></script>
  <script src="jsPsych-6/plugins/jspsych-survey-html-form.js"></script>

  <script src="controllers/js/script_loading.js"></script>

  <!-- Database initialization and control -->
  <script src="controllers/js/mysql_controller.js"></script>
  <script src="controllers/js/indexedDB.js"></script>
  <script src="controllers/js/save_data.js"></script>

  <!-- General Options -->
  <script>
    let params = new URLSearchParams(location.search);
    online = true;
    uid = -1;
    uid_external = -1;
    pid = 999;
    // participantes m√°ximos por condicion
    max_participants = 1;
    // usado para bloquear el experimento en caso de que se superen todas las condiciones
    iterations_for_review = 1;
    max_time = "00:01:30";
    random = false;
    // aceptar usuarios que fueron descartados si es que hay espacio
    accept_discarded = true;


    //addIndexed("user" + pid.toString(), { user: uid.toString(), start_date: actual_time, completed_experiments: [experiment], between_selection: between_selection, within_selection: within_selection }, db);

    between_selection = {};
    within_selection = {};
    completed_experiments = [];
    user_assigned = false;

    actual_condition_data = [];

    // ordered elements at the beginning
    all_experiments = ['Welcome'];

    // ordered elements at the end
    ending = ['Goodbye'];

    // not neccesary ordered elements in the middle
    not_ordered_experiments = ['Between-Within'];

    // obtaining final array (if random)
    var all_experiments = (random) ? (all_experiments.concat(jsPsych.randomization.shuffle(not_ordered_experiments))) : (all_experiments.concat(not_ordered_experiments));
    all_experiments = all_experiments.concat(ending);

    // imagenes para precarga en protocol_controller
    img_folder = 'tasks/img/';
    images = [img_folder + 'VPN_low.png', img_folder + 'VPN_high.png', img_folder + 'VPP_low.png', img_folder + 'VPP_high.png'];
    audio = [];
    video = [];

    if (online) {
      start_mysqldb(pid, max_participants);
      charge_clean_mysql(iterations_for_review, max_participants);
    } else {
      charge_clean_indexeddb(iterations_for_review, max_participants);
    }

  </script>

  <div style="top:50%; position: absolute; transform: translate(-50%, -50%); left:50%; text-align:center"> <!--margin-top:45%;-->
    <span id="text_input_uid"> Introduce un uid </span> <br> <br>
    <input id="input_uid" type="number" required step="1" min="0"></input>
    <input id="check" type="submit" onclick="check_id_status(event)" value="Comenzar" disabled='true'></input>
    <input id="start" type="button" onclick="start_protocol(questions)" value="Continuar" hidden='true'></input>
  </div>

  <!-- PROTOCOL MACHINERY -->
  <script src="controllers/js/protocol_controller.js"></script>

  <script> window.onload = check_id_status(); </script>

  <script type="text/javascript" src="controllers/js/css_loading.js"></script>

  </body>
</html>
